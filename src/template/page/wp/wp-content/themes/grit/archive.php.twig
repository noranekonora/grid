{% extends '../../../../../layout/_01_lower.twig' %}

{# グローバルメニュー カレント固定  #}
{% set currentID = '5' %}

{# ページタイトル設定 #}
{% set pageTitle = 'news' %}
{% set subTitle = 'お知らせ' %}

{# ページID設定 #}
{% set pageId = 'archive-news' %}

{# OGP関連設定
※descriptionを記入しなければ、「〇〇」の「〇〇」のページです。とデフォルトの文言が出力されます。
※ogurlはルート相対パスで「必ず」記入してください
※ページ毎にOGP画像を変更した場合は、ogimagepathに画像のパスをルート相対パスで入力してください。記述がなければ、デフォルトのOGP画像が表示されます。　#}
{% set description = '' %}
{% set ogurlpath = '/news/' %}

{# ページ個別 CSS等 #}
{% block headArea %}
<?php wp_head(); ?>
<link rel="stylesheet" type="text/css" href="{{ inc.css }}/page/archive.css">
{% endblock %}

{# コンテンツをここに記載(div#contents内) #}
{% block contents %}

<div class="l-section l-section--sm">
<ul class="c-newslist">
  <?php
        $paged = ( get_query_var( 'paged' ) ) ? absint( get_query_var( 'paged' ) ) : 1;//ポイント1
        $args = array(
          'paged' => $paged,//ポイント2
          'posts_per_page' => 6,//ポイント3
          );
          $query = new WP_Query( $args );
          ?>
          <?php if( $query->have_posts() ) : ?>
            <?php while ( $query->have_posts() ) : $query->the_post(); ?>
        <li class="c-newslist__item">
          <a href="<?php the_permalink(); ?>" {% if newslist.target_blank %}target="_blank" rel="noopener" {% endif %}>
            <dl>
              <dt>
                <span class="c-newslist__date"><?php echo get_the_date("Y.m.d"); ?></span>
                <span
                  class="c-label {% if newslist.category %}c-label__{{ newslist.category }}{% endif %}"><?php $cat = get_the_category(); $cat = $cat[0]; { echo $cat->cat_name; } ?></span>
              </dt>
              <dd><?php the_title(); ?></dd>
            </dl>
          </a>
        </li>
          <?php endwhile; wp_reset_postdata(); ?>
          <?php else : ?>
          <p class="">記事が見つかりませんでした。</p>
        <?php endif; ?>
      </ul>
</div>

<?php
          $big = 999999999; // need an unlikely integer
          echo paginate_links([
            'base' => str_replace($big, '%#%', esc_url(get_pagenum_link($big))),
            'format' => '?page=%#%',
            'current' => max(1, get_query_var('paged')),
            'total' => $query->max_num_pages,
            'prev_text' => __('&lt;'),
            'next_text' => __('&gt;'),
          ]);
        ?>

{# pagination #}
<?php if( function_exists("the_pagination") ) the_pagination(); ?>
{# pagination #}

{% endblock %}


{# ページ個別　JS等 #}
{% block jsArea %}
<?php wp_footer(); ?>
{% endblock %}
